<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Parent child relationships</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Parent child relationships</h1><br/><p><img src="images/16-1.png" alt="images/16-1.png" /></p><p></p><p>When running a command with the tcp filter turned off in procmon, we can see the malware searches the pwd, doesn&#39;t find cmd.exe, so it searches the system32</p><p></p><p><img src="images/16-2.png" alt="images/16-2.png" /></p><p></p><p>by observing the process tree, we can see RAT.Unknown2.exe is a child of explorer.exe, which is the parent process with anything interactive on a windows system </p><p>we can also see the commands associated with the spawned processes</p><p><img src="images/16-3.png" alt="images/16-3.png" /></p><p></p><p>We can then pivot our procmon filter to instead of Unknown.Rat2.exe, to the Process Parent ID of 1556 (Rat.Unknown2.exe) </p><p><img src="images/16-4.png" alt="images/16-4.png" /></p></div>
</body>
</html>
