<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Packing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Packing</h1><br/><p>Packing is like a compression algorthim to make it look different from its original source </p><p></p><p>UPX is a very popular packing program </p><p></p><p>Packing program take a Packer stub (compression stub/coder stub) and puts it in the begining of the code. It then takes  takes all the code below the stub and crunches it down (packs). The resulting program is now much smaller. </p><p></p><p>At runtime, the stub looks at the exectuable code and expands it to the original size. </p><p></p><p>This helps malware evade AV </p><p></p><p>This is a packed malware and we can see in the import address table there are very little API functions </p><p>	Even the simplest programs have more API functions than what is seen below </p><p>	</p><p>	<img src="images/8-1.png" alt="images/8-1.png" /></p><p>	GetProcAddress and LoadLibrary A are two API calls that are used to identify other imports at runtime </p><p>	This packed program has to find the APIs in the loaded DLLs </p><p>	When the packed malware decompresses, getprocaddress and loadlibraryA are invoked to find the other API calls </p><p>	</p><p>	</p><p>We can see that the Virtual size is much bigger than the size of the raw data </p><p><img src="images/8-2.png" alt="images/8-2.png" /></p><p>This is because the raw data does not exist yet </p><p></p><p><img src="images/8-3.png" alt="images/8-3.png" /></p><p></p><p>Pestudio </p><p>Packed</p><p><img src="images/8-4.png" alt="images/8-4.png" /></p><p><img src="images/8-5.png" alt="images/8-5.png" /></p><p></p><p>Unpacked</p><p><img src="images/8-6.png" alt="images/8-6.png" /></p><p><img src="images/8-7.png" alt="images/8-7.png" /></p></div>
</body>
</html>
