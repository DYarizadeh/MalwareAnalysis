<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Wireshark/Analyzing RAT</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Wireshark/Analyzing RAT</h1><br/><p>Specimine - RAT.Unknown.Malz.exe</p><p></p><p>Run floss (strings utility) </p><p><img src="images/13-1.png" alt="images/13-1.png" /></p><p></p><p>We can find some indicators in the strings output </p><p><img src="images/13-2.png" alt="images/13-2.png" /></p><p></p><p>Before detonating, open wireshark on remnux and start capturing traffic </p><p>Once traffic is captured, analize higher protocols first as they are usually more interesting (example below, review http before tcp) </p><p><img src="images/13-3.png" alt="images/13-3.png" /></p><p></p><p>In above screen shot, the user agent is intresting as well as the full URI request </p><p></p><p>The get request in the screenshot below is also interesting and good to note the executable (2nd stage payload/additional capabilities) </p><p><img src="images/13-4.png" alt="images/13-4.png" /></p><p></p><p>We can right click and hit follow -&gt; http stream to see more human readable data</p><p><img src="images/13-5.png" alt="images/13-5.png" /></p><p></p><p><img src="images/13-6.png" alt="images/13-6.png" /></p><p></p><p>We can see the get request for mscorelib.exe as well as the inetsim default exe response </p><p></p><p>Important to note there is no guarentee that on an actual infected host the downloaded payload will be named what is labeled in the GET Request. Internet traffic and wirting to disk can be two different transactions. Data can be downloaded first and then written to disk under a different name (dechaining or decoupling). </p><p></p></div>
</body>
</html>
